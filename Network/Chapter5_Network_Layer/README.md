# 네트워크 계층: 목적지에 데이터 전달하기

## 네트워크 계층의 역할

- 서로 다른 네트워크에 있는 목적지로 데이터를 전송하기 위해 필요

### 네트워크 간의 연결 구조

- 데이터 링크 계층에선 이더넷 규칙을 따라 같은 네트워크에 있는 컴퓨터로만 전송 가능하다.

- 네트워크 간의 통신을 가능하게 **라우터**를 사용한다.

  - 라우터: 해당 목적지까지 어떤 경로로 가는 것이 좋은지 알려주는 네트워크 장비이다.

  - IP 주소: 라우터가 해당 목적지를 찾을 수 있게 하는 네트워크 식별 주소이다.

<br>

### IP 헤더

데이터를 정확하게 전달하기 위해 필요한 정보가 포함되어 있다.

1. 버전(version)

2. 헤더 길이(header length)

3. 서비스 유형(service type)

4. 전체 패킷 길이(total length)

5. ID(identification, 일련번호)

6. 조각 상태(flags)

7. 조각의 위치(fragment offset)

8. TTL

9. 프로토콜(protocol)

10. 헤더 체크섬(header checksum)

11. **출발지 IP 주소(source IP address)** (32 비트)

12. **목적지 IP 주소(destination IP address)** (32 비트)

<br>

## IP 주소의 구조

- 인터넷 서비스 제공자(ISP)에게 받을 수 있다.

- 공인 IP 주소

  - 인터넷에 직접 연결되는 컴퓨터나 라우터에 할당

- 사설 IP 주소

  - 회사나 가정의 랜에 잇는 컴퓨터에 할당

- 비트 수

  - MAC: 48비트 -> 16진수

  - IP: 32비트 -> 10진수

### 네트워크 ID, 호스트 ID

- 네트워크 ID: 어떤 네트워크인지 나타낸다.

- 호스트 ID: 해당 네트워크의 어느 컴퓨터인지를 나타낸다.

<br>

## IP 주소의 클래스 구조

### IP 주소 클래스

- 네트워크 ID를 크게 만들거나 호스트 ID를 작게 만들어 네트워크 크기를 조정할 수도 있따.

  - 네트워크의 크기 -> 클래스 개념으로 구분

| 클래스 이름 |                내용                 |
| :---------: | :---------------------------------: |
|  A 클래스   |        대규모 네트워크 주소         |
|  B 클래스   |         중형 네트워크 주소          |
|  C 클래스   |        소규모 네트워크 주소         |
|  D 클래스   | 멀티캐스트(multicast) 네트워크 주소 |
|  E 클래스   |        연구 및 특수용도 주소        |

- A 클래스

  - 처음 8비트가 네트워크 ID이고 다음 24비트가 호스트 ID이다.
  - `| 0000 0001 || 0000 0000 | 0000 0000 | 0000 0000 |`

- B 클래스

  - 처음 16비트가 네트워크 ID이고 다음 16비트가 호스트 ID이다
  - `| 1000 0000 | 0000 0000 || 0000 0000 | 0000 0000 |`

- C 클래스
  - 처음 24비트가 네트워크 ID이고 다음 8비트가 호스트 ID이다
  - `| 1000 0000 | 0000 0000 | 0000 0000 || 0000 0000 |`

<br>

### 공인 IP 주소 , 사설 IP 주소 포함 클래스 범위

- A 클래스

  - 1 옥텟(8비트) 범위 : 2진수로 0000 0001 ~ 0111 1111, 10진수로 1 ~ 127
  - 2 ~ 4 옥텟 범위 : 2진수로 각각 0000 0000 ~ 1111 1111, 10진수로 0 ~ 255
  - 32 비트 전체 범위 : 1.0.0.0 ~ 127.255.255.255
  - 호스트 수: 1677만 7214대

- B 클래스

  - 1 옥텟 범위 : 2진수로 1000 0000 ~ 1011 1111, 10진수로 128 ~ 191
  - 2 ~ 4 옥텟 범위 : 2진수로 각각 0000 0000 ~ 1111 1111, 10진수로 0 ~ 255
  - 32 비트 전체 범위 : 128.0.0.0 ~ 191.255.255.255
  - 호스트 수: 6만 5534대

- C 클래스
  - 1 옥텟 범위 : 2진수로 1100 0000 ~ 1101 1111, 10진수로 192 ~ 223
  - 2 ~ 4 옥텟 범위 : 2진수로 각각 0000 0000 ~ 1111 1111, 10진수로 0 ~ 255
  - 32 비트 전체 범위 : 192.0.0.0 ~ 223.255.255.255
  - 호스트 수: 254대

|   종류   |      공인 IP 주소의 범위      |
| :------: | :---------------------------: |
| A 클래스 |    1.0.0.0 ~ 9.255.255.255    |
|          |  11.0.0.0 ~ 126.255.255.255   |
| B 클래스 |  128.0.0.0 ~ 172.15.255.255   |
|          | 172.32.0.0 ~ 191.255.255.255  |
| C 클래스 |  192.0.0.0 ~ 192.167.255.255  |
|          | 192.169.0.0 ~ 223.255.255.255 |

- 사설 IP 주소는 절대로 공인 IP 주소로 사용할 수 없다.

<br>

|   종류   |      공인 IP 주소의 범위      |
| :------: | :---------------------------: |
| A 클래스 |   10.0.0.0 ~ 10.255.255.255   |
| B 클래스 |  172.16.0.0 ~ 172.31.255.255  |
| C 클래스 | 192.168.0.0 ~ 192.168.255.255 |

<br>

## 네트워크 주소와 브로드캐스트 주소의 구조

### 네트워크 주소와 브로드캐스트 주소란?

- 컴퓨터나 라우터가 자신의 IP로 사용하면 안되는 주소

- 네트워크 주소:

  - 호스트 ID가 10진수로 0, 2진수로 00000000인 주소
  - 전체 네트워크에서 **작은 네트워크**를 식별하는 데 사용
  - 네트워크의 대표 주소

- 브로트캐스트 주소: 호스트 ID가 10진수로 255, 2진수로 11111111인 주소
  - 한 번에 데이터를 전송하는 데 사용되는 전용 IP 주소

<br>

## 서브넷의 구조

### 서브넷이란?

- A 클래스등의 대규모 네트워크를 작은 네트워크로 분할하여 브로드캐스트로 전송되는 패킷의 범위를 좁힌다.

- 네트워크 ID, 호스트 ID -> 네트워크 ID, 서브넷 ID, 호스트 iD

<br>

### 서브넷 마스크란?

- 네트워크 ID와 호스트 ID를 식별하기 위한 값

<br>

## 라우터의 구조

### 라우터란?

- 네트워크를 분리할 수 있다.

  - 스위치(레이어 2 스위치)만 있는 네트워크에서는 모든 컴퓨터와 스위치가 동일한 네트워크에 속한다.

- 기본 게이트웨이

  - 컴퓨터 1이 다른 네트워크에 데이터를 전송하기 위해선 라우터 IP 주소를 설정해야한다.
  - 네트워크의 출입구에 해당한다.

<br>

### 라우팅이란?

- 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송하는 것이다.

- 라우팅 테이블: 최적의 경로 정보가 등록되어 있는 테이블이다.

- 라우팅 프로토콜:
  - 라우팅 정보를 굥환하기 위한 프로토콜
  - 라우터 간에 경로 정보를 서로 교환하고 그것을 라우팅 테이블에 등록해 나간다.
  - RIP, OSPF, BGP
